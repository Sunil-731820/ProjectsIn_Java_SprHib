package infinite.RealTimeLeaveMangement;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

public class EmployeeDAO {
	Connection connection;
	PreparedStatement pst;
//	second task is to showAll Employee Records from the table 
	public Employee[] ShowAllEmployee() throws ClassNotFoundException, SQLException {
		connection = ConnectionHelper.getConnection();
		String cmd = "select *from EMPLOYEE where EMP_ID=?";
		List<Employee> employeelist = new ArrayList();
		pst = connection.prepareStatement(cmd);
		ResultSet res = pst.executeQuery();
		Employee employee = null;
		while(res.next()) {
			employee = new Employee();
			System.out.println("The Employee is " + res.getInt("EMP_ID"));
			System.out.println("the Employee Name is "+ res.getString("EMP_NAME"));
			System.out.println("The Employee MAil is " + res.getString("EMP_MAIL"));
			System.out.println("The Employee Mobile Number is " + res.getInt("EMP_MOB_NO"));
			System.out.println("The Employee date of joining is" + res.getDate("EMP_DT_JOIN"));
			System.out.println("The Employee Department is " + res.getString("EMP_DEPT"));
			System.out.println("The Employee Manager Id is " + res.getInt("EMP_MANAGER_ID"));
			System.out.println("The Employee Leave Bal is " + res.getInt("EMP_AVAIL_LEAVE_BAL"));
		}
		return employeelist.toArray(new Employee[employeelist.size()]);

	}
	
	
	
//	first we have to perform search Operations 
	public Employee searchEmployee(int EMP_ID) throws ClassNotFoundException, SQLException {
		connection = ConnectionHelper.getConnection();
		String cmd = "select *from EMPLOYEE where EMP_ID=?";
		pst = connection.prepareStatement(cmd);
		pst.setInt(1, EMP_ID);
		ResultSet res = pst.executeQuery();
		Employee leave = null;
		if(res.next()) {
		    leave = new Employee();
			leave.setEMP_ID(res.getInt("EMP_ID"));
			leave.setEmp_NAME(res.getString("EMP_NAME"));
			leave.setEMP_MAIL(res.getString("EMP_MAIL"));
			leave.setEMP_MOB_NO(res.getString("EMP_MOB_NO"));
			leave.setEMP_DT_JOIN(res.getDate("EMP_DT_JOIN"));
			leave.setEMP_DEPT(res.getString("EMP_DEPT"));
			leave.setEMP_MANAGER_ID(res.getInt("EMP_MANAGER_ID"));
			leave.setEMP_AVAIL_LEAVE_BAL(res.getInt("EMP_AVAIL_LEAVE_BAL"));
		}
		return leave;
	}
}
